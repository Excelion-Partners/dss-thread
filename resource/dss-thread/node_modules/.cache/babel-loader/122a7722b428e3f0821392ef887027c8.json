{"ast":null,"code":"import _classCallCheck from\"/Users/ryan/Documents/Documents - Ryan\\u2019s MacBook Pro/source_code/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/ryan/Documents/Documents - Ryan\\u2019s MacBook Pro/source_code/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/ryan/Documents/Documents - Ryan\\u2019s MacBook Pro/source_code/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/ryan/Documents/Documents - Ryan\\u2019s MacBook Pro/source_code/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/ryan/Documents/Documents - Ryan\\u2019s MacBook Pro/source_code/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Fragment}from\"react\";import{Component}from'react';import{useEffect}from'react';import logo from\"./logo.svg\";import'./App.css';import Button from'react-bootstrap/Button';import Container from'react-bootstrap/Container';import Row from'react-bootstrap/Row';import Form from'react-bootstrap/Form';import Col from'react-bootstrap/Col';import'bootstrap/dist/css/bootstrap.min.css';import{Typeahead}from'react-bootstrap-typeahead';import eventBus from\"./eventBus\";import{BrowserRouter as Router,Switch,Route,Routes,Link}from\"react-router-dom\";import Dataset from'./components/dataset.js';var App=/*#__PURE__*/function(_Component){_inherits(App,_Component);var _super=_createSuper(App);function App(props){var _this;_classCallCheck(this,App);_this=_super.call(this,props);_this.handleClick=function(){console.log('The link was clicked.');window.$.getJSON(window.getWebAppBackendUrl('initialize'),function(data){var output=window.$('<pre />').text('Backend reply: '+JSON.stringify(data));window.$('body').append(output);});};_this.findDataset=function(tree,key){var proj=key.split('.')[0];var ds_name=key.split('.')[1];var p_ref=tree[proj];console.log(p_ref);return p_ref.datasets.find(function(_ref){var name=_ref.name;return name===ds_name;});};_this.refreshData=function(){fetch(window.getWebAppBackendUrl('get-projects')).then(function(res){return res.json();}).then(function(result){var p_list=[];Object.keys(result).forEach(function(proj_name){for(var x=0;x<result[proj_name].datasets.length;x++){var ds=result[proj_name].datasets[x];p_list[p_list.length]={id:proj_name+'.'+ds.name,label:ds.name+' ('+proj_name+')'};}});_this.setState({isLoaded:true,project_list:p_list,full_tree:result});});};_this.state={rendered:false,dataiku:undefined,isLoaded:false,project_list:[],full_ds_name:'',full_tree:{},selectedDataset:null};_this.project_list=[];// This binding is necessary to make `this` work in the callback\n_this.handleClick=_this.handleClick.bind(_assertThisInitialized(_this));return _this;}_createClass(App,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;window.$(document).ready(function(){_this2.setState({dataiku:window.dataiku});_this2.setState({rendered:true});eventBus.on(\"dataRefresh\",function(data){return _this2.refreshData();});_this2.refreshData();});}},{key:\"render\",value:function render(){var _this3=this;//        <Router>\n//     <main>\n//       <nav>\n//         <ul>\n//           <li><Link to=\"/\">Home</Link></li>\n//           <li><a href=\"/about\">About</a></li>\n//           <li><a href=\"/contact\">Contact</a></li>\n//         </ul>\n//       </nav>\n//             <Routes>\n//   <Route path=\"/\" exact component={Home} />\n//             </Routes>\n//     </main>\n// </Router>\n// )\nvar _this$state=this.state,isLoaded=_this$state.isLoaded,project_list=_this$state.project_list,full_tree=_this$state.full_tree,showDetail=_this$state.showDetail,selectedDataset=_this$state.selectedDataset,full_ds_name=_this$state.full_ds_name;var ref=React.createRef();if(!isLoaded){return/*#__PURE__*/React.createElement(\"div\",null,\"Loading...\");}else{if(selectedDataset==null){return/*#__PURE__*/React.createElement(Container,{style:{paddingTop:'20px'}},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Typeahead,{ref:ref,placeholder:\"Search for Dataset\",onChange:function onChange(selected){if(selected.length>0){_this3.setState({selectedDataset:_this3.findDataset(full_tree,selected[0].id),full_ds_name:selected[0].id});ref.current.clear();};},options:project_list})));}else{return/*#__PURE__*/React.createElement(Container,{style:{paddingTop:'20px'}},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Typeahead,{ref:ref,placeholder:\"Search for Dataset\",onChange:function onChange(selected){if(selected.length>0){_this3.setState({selectedDataset:_this3.findDataset(full_tree,selected[0].id),full_ds_name:selected[0].id});ref.current.clear();};},options:project_list})),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Dataset,{deets:selectedDataset,full_ds_name:full_ds_name})));}}}}]);return App;}(Component);export default App;","map":{"version":3,"sources":["/Users/ryan/Documents/Documents - Ryanâ€™s MacBook Pro/source_code/dss-thread/resource/thread/src/App.js"],"names":["React","Fragment","Component","useEffect","Button","Container","Row","Form","Col","Typeahead","eventBus","BrowserRouter","Router","Switch","Route","Routes","Link","Dataset","App","props","handleClick","console","log","window","$","getJSON","getWebAppBackendUrl","data","output","text","JSON","stringify","append","findDataset","tree","key","proj","split","ds_name","p_ref","datasets","find","name","refreshData","fetch","then","res","json","result","p_list","Object","keys","forEach","proj_name","x","length","ds","id","label","setState","isLoaded","project_list","full_tree","state","rendered","dataiku","undefined","full_ds_name","selectedDataset","bind","document","ready","on","showDetail","ref","createRef","paddingTop","selected","current","clear"],"mappings":"mjCAAA,MAAOA,CAAAA,KAAP,EAAgBC,QAAhB,KAAgC,OAAhC,CACA,OAASC,SAAT,KAA0B,OAA1B,CACA,OAASC,SAAT,KAA0B,OAA1B,C,6BAGA,MAAO,WAAP,CACA,MAAOC,CAAAA,MAAP,KAAmB,wBAAnB,CACA,MAAOC,CAAAA,SAAP,KAAsB,2BAAtB,CACA,MAAOC,CAAAA,GAAP,KAAgB,qBAAhB,CACA,MAAOC,CAAAA,IAAP,KAAiB,sBAAjB,CACA,MAAOC,CAAAA,GAAP,KAAgB,qBAAhB,CACA,MAAO,sCAAP,CACA,OAASC,SAAT,KAA0B,2BAA1B,CACA,MAAOC,CAAAA,QAAP,KAAqB,YAArB,CACA,OACIC,aAAa,GAAIC,CAAAA,MADrB,CAEIC,MAFJ,CAGIC,KAHJ,CAIIC,MAJJ,CAKIC,IALJ,KAMO,kBANP,CAOA,MAAOC,CAAAA,OAAP,KAAoB,yBAApB,C,GAEMC,CAAAA,G,0FAEF,aAAYC,KAAZ,CAAmB,qCACf,uBAAMA,KAAN,EADe,MAmBnBC,WAnBmB,CAmBL,UAAM,CAChBC,OAAO,CAACC,GAAR,CAAY,uBAAZ,EAEAC,MAAM,CAACC,CAAP,CAASC,OAAT,CAAiBF,MAAM,CAACG,mBAAP,CAA2B,YAA3B,CAAjB,CAA2D,SAAUC,IAAV,CAAgB,CACvE,GAAMC,CAAAA,MAAM,CAAGL,MAAM,CAACC,CAAP,CAAS,SAAT,EAAoBK,IAApB,CAAyB,kBAAoBC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA7C,CAAf,CACAJ,MAAM,CAACC,CAAP,CAAS,MAAT,EAAiBQ,MAAjB,CAAwBJ,MAAxB,EACH,CAHD,EAKH,CA3BkB,OA6BnBK,WA7BmB,CA6BL,SAACC,IAAD,CAAOC,GAAP,CAAe,CACzB,GAAIC,CAAAA,IAAI,CAAGD,GAAG,CAACE,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAX,CACA,GAAIC,CAAAA,OAAO,CAAGH,GAAG,CAACE,KAAJ,CAAU,GAAV,EAAe,CAAf,CAAd,CAEA,GAAIE,CAAAA,KAAK,CAAGL,IAAI,CAACE,IAAD,CAAhB,CACAf,OAAO,CAACC,GAAR,CAAYiB,KAAZ,EAEA,MAAOA,CAAAA,KAAK,CAACC,QAAN,CAAeC,IAAf,CAAoB,kBAAGC,CAAAA,IAAH,MAAGA,IAAH,OAAcA,CAAAA,IAAI,GAAKJ,OAAvB,EAApB,CAAP,CACH,CArCkB,OAuCnBK,WAvCmB,CAuCL,UAAM,CAChBC,KAAK,CAACrB,MAAM,CAACG,mBAAP,CAA2B,cAA3B,CAAD,CAAL,CACKmB,IADL,CACU,SAAAC,GAAG,QAAIA,CAAAA,GAAG,CAACC,IAAJ,EAAJ,EADb,EAEKF,IAFL,CAGQ,SAACG,MAAD,CAAY,CACR,GAAIC,CAAAA,MAAM,CAAG,EAAb,CACAC,MAAM,CAACC,IAAP,CAAYH,MAAZ,EAAoBI,OAApB,CAA4B,SAAUC,SAAV,CAAqB,CAC7C,IAAK,GAAIC,CAAAA,CAAC,CAAG,CAAb,CAAgBA,CAAC,CAAGN,MAAM,CAACK,SAAD,CAAN,CAAkBb,QAAlB,CAA2Be,MAA/C,CAAuDD,CAAC,EAAxD,CAA4D,CACxD,GAAIE,CAAAA,EAAE,CAAGR,MAAM,CAACK,SAAD,CAAN,CAAkBb,QAAlB,CAA2Bc,CAA3B,CAAT,CACAL,MAAM,CAACA,MAAM,CAACM,MAAR,CAAN,CAAwB,CAAEE,EAAE,CAAEJ,SAAS,CAAG,GAAZ,CAAkBG,EAAE,CAACd,IAA3B,CAAiCgB,KAAK,CAAEF,EAAE,CAACd,IAAH,CAAU,IAAV,CAAiBW,SAAjB,CAA6B,GAArE,CAAxB,CACH,CACJ,CALD,EAOA,MAAKM,QAAL,CAAc,CACVC,QAAQ,CAAE,IADA,CAEVC,YAAY,CAAEZ,MAFJ,CAGVa,SAAS,CAAEd,MAHD,CAAd,EAKH,CAjBT,EAkBH,CA1DkB,CAGf,MAAKe,KAAL,CAAa,CACTC,QAAQ,CAAE,KADD,CAETC,OAAO,CAAEC,SAFA,CAGTN,QAAQ,CAAE,KAHD,CAITC,YAAY,CAAE,EAJL,CAKTM,YAAY,CAAE,EALL,CAMTL,SAAS,CAAE,EANF,CAOTM,eAAe,CAAE,IAPR,CAAb,CAUA,MAAKP,YAAL,CAAoB,EAApB,CAEA;AACA,MAAKzC,WAAL,CAAmB,MAAKA,WAAL,CAAiBiD,IAAjB,+BAAnB,CAhBe,aAiBlB,C,iDA2CD,4BAAoB,iBAChB9C,MAAM,CAACC,CAAP,CAAS8C,QAAT,EAAmBC,KAAnB,CAAyB,UAAM,CAC3B,MAAI,CAACZ,QAAL,CAAc,CAAEM,OAAO,CAAE1C,MAAM,CAAC0C,OAAlB,CAAd,EACA,MAAI,CAACN,QAAL,CAAc,CAAEK,QAAQ,CAAE,IAAZ,CAAd,EAEAtD,QAAQ,CAAC8D,EAAT,CAAY,aAAZ,CAA2B,SAAC7C,IAAD,QACvB,CAAA,MAAI,CAACgB,WAAL,EADuB,EAA3B,EAIA,MAAI,CAACA,WAAL,GACH,CATD,EAYH,C,sBAED,iBAAS,iBACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAyF,KAAKoB,KAA9F,CAAQH,QAAR,aAAQA,QAAR,CAAkBC,YAAlB,aAAkBA,YAAlB,CAAgCC,SAAhC,aAAgCA,SAAhC,CAA2CW,UAA3C,aAA2CA,UAA3C,CAAuDL,eAAvD,aAAuDA,eAAvD,CAAwED,YAAxE,aAAwEA,YAAxE,CACA,GAAMO,CAAAA,GAAG,CAAG1E,KAAK,CAAC2E,SAAN,EAAZ,CAEA,GAAI,CAACf,QAAL,CAAe,CACX,mBAAO,4CAAP,CACH,CAFD,IAEO,CACH,GAAIQ,eAAe,EAAI,IAAvB,CAA6B,CACzB,mBACI,oBAAC,SAAD,EAAW,KAAK,CAAE,CAAEQ,UAAU,CAAE,MAAd,CAAlB,eACI,oBAAC,GAAD,mBACI,oBAAC,SAAD,EACI,GAAG,CAAEF,GADT,CAEI,WAAW,CAAC,oBAFhB,CAGI,QAAQ,CAAE,kBAACG,QAAD,CAAc,CACpB,GAAIA,QAAQ,CAACtB,MAAT,CAAkB,CAAtB,CAAyB,CACrB,MAAI,CAACI,QAAL,CAAc,CACVS,eAAe,CAAE,MAAI,CAACnC,WAAL,CAAiB6B,SAAjB,CAA4Be,QAAQ,CAAC,CAAD,CAAR,CAAYpB,EAAxC,CADP,CAEVU,YAAY,CAAEU,QAAQ,CAAC,CAAD,CAAR,CAAYpB,EAFhB,CAAd,EAIAiB,GAAG,CAACI,OAAJ,CAAYC,KAAZ,GACH,EACJ,CAXL,CAYI,OAAO,CAAElB,YAZb,EADJ,CADJ,CADJ,CAoBH,CArBD,IAsBK,CACD,mBACI,oBAAC,SAAD,EAAW,KAAK,CAAE,CAAEe,UAAU,CAAE,MAAd,CAAlB,eACI,oBAAC,GAAD,mBACI,oBAAC,SAAD,EACI,GAAG,CAAEF,GADT,CAEI,WAAW,CAAC,oBAFhB,CAGI,QAAQ,CAAE,kBAACG,QAAD,CAAc,CACpB,GAAIA,QAAQ,CAACtB,MAAT,CAAkB,CAAtB,CAAyB,CACrB,MAAI,CAACI,QAAL,CAAc,CACVS,eAAe,CAAE,MAAI,CAACnC,WAAL,CAAiB6B,SAAjB,CAA4Be,QAAQ,CAAC,CAAD,CAAR,CAAYpB,EAAxC,CADP,CAEVU,YAAY,CAAEU,QAAQ,CAAC,CAAD,CAAR,CAAYpB,EAFhB,CAAd,EAIAiB,GAAG,CAACI,OAAJ,CAAYC,KAAZ,GACH,EACJ,CAXL,CAYI,OAAO,CAAElB,YAZb,EADJ,CADJ,cAiBI,oBAAC,GAAD,mBACI,oBAAC,OAAD,EAAS,KAAK,CAAEO,eAAhB,CAAiC,YAAY,CAAED,YAA/C,EADJ,CAjBJ,CADJ,CAuBH,CACJ,CACJ,C,iBAnJajE,S,EAsJlB,cAAegB,CAAAA,GAAf","sourcesContent":["import React, { Fragment } from \"react\";\nimport { Component } from 'react';\nimport { useEffect } from 'react';\n\nimport logo from './logo.svg';\nimport './App.css';\nimport Button from 'react-bootstrap/Button';\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Form from 'react-bootstrap/Form'\nimport Col from 'react-bootstrap/Col';\nimport 'bootstrap/dist/css/bootstrap.min.css';\nimport { Typeahead } from 'react-bootstrap-typeahead';\nimport eventBus from \"./eventBus\";\nimport {\n    BrowserRouter as Router,\n    Switch,\n    Route,\n    Routes,\n    Link\n} from \"react-router-dom\";\nimport Dataset from './components/dataset.js';\n\nclass App extends Component {\n\n    constructor(props) {\n        super(props)\n\n        this.state = {\n            rendered: false,\n            dataiku: undefined,\n            isLoaded: false,\n            project_list: [],\n            full_ds_name: '',\n            full_tree: {},\n            selectedDataset: null\n        };\n\n        this.project_list = []\n\n        // This binding is necessary to make `this` work in the callback\n        this.handleClick = this.handleClick.bind(this);\n    }\n\n    handleClick = () => {\n        console.log('The link was clicked.');\n\n        window.$.getJSON(window.getWebAppBackendUrl('initialize'), function (data) {\n            const output = window.$('<pre />').text('Backend reply: ' + JSON.stringify(data));\n            window.$('body').append(output)\n        });\n\n    }\n\n    findDataset = (tree, key) => {\n        var proj = key.split('.')[0];\n        var ds_name = key.split('.')[1];\n\n        var p_ref = tree[proj];\n        console.log(p_ref);\n\n        return p_ref.datasets.find(({ name }) => name === ds_name);\n    }\n\n    refreshData = () => {\n        fetch(window.getWebAppBackendUrl('get-projects'))\n            .then(res => res.json())\n            .then(\n                (result) => {\n                    var p_list = []\n                    Object.keys(result).forEach(function (proj_name) {\n                        for (var x = 0; x < result[proj_name].datasets.length; x++) {\n                            var ds = result[proj_name].datasets[x];\n                            p_list[p_list.length] = { id: proj_name + '.' + ds.name, label: ds.name + ' (' + proj_name + ')' };\n                        }\n                    });\n\n                    this.setState({\n                        isLoaded: true,\n                        project_list: p_list,\n                        full_tree: result\n                    });\n                });\n    }\n\n    componentDidMount() {\n        window.$(document).ready(() => {\n            this.setState({ dataiku: window.dataiku });\n            this.setState({ rendered: true });\n\n            eventBus.on(\"dataRefresh\", (data) =>\n                this.refreshData()\n            );\n\n            this.refreshData()\n        }\n\n        );\n    }\n\n    render() {\n        //        <Router>\n        //     <main>\n        //       <nav>\n        //         <ul>\n        //           <li><Link to=\"/\">Home</Link></li>\n        //           <li><a href=\"/about\">About</a></li>\n        //           <li><a href=\"/contact\">Contact</a></li>\n        //         </ul>\n        //       </nav>\n        //             <Routes>\n        //   <Route path=\"/\" exact component={Home} />\n        //             </Routes>\n        //     </main>\n        // </Router>\n        // )\n        const { isLoaded, project_list, full_tree, showDetail, selectedDataset, full_ds_name } = this.state;\n        const ref = React.createRef();\n\n        if (!isLoaded) {\n            return <div>Loading...</div>;\n        } else {\n            if (selectedDataset == null) {\n                return (\n                    <Container style={{ paddingTop: '20px' }}>\n                        <Row>\n                            <Typeahead\n                                ref={ref}\n                                placeholder='Search for Dataset'\n                                onChange={(selected) => {\n                                    if (selected.length > 0) {\n                                        this.setState({\n                                            selectedDataset: this.findDataset(full_tree, selected[0].id),\n                                            full_ds_name: selected[0].id\n                                        });\n                                        ref.current.clear()\n                                    };\n                                }}\n                                options={project_list}\n                            />\n                        </Row>\n                    </Container>\n                );\n            }\n            else {\n                return (\n                    <Container style={{ paddingTop: '20px' }}>\n                        <Row>\n                            <Typeahead\n                                ref={ref}\n                                placeholder='Search for Dataset'\n                                onChange={(selected) => {\n                                    if (selected.length > 0) {\n                                        this.setState({\n                                            selectedDataset: this.findDataset(full_tree, selected[0].id),\n                                            full_ds_name: selected[0].id\n                                        })\n                                        ref.current.clear()\n                                    };\n                                }}\n                                options={project_list}\n                            />\n                        </Row>\n                        <Row>\n                            <Dataset deets={selectedDataset} full_ds_name={full_ds_name}></Dataset>\n                        </Row>\n                    </Container>\n                );\n            }\n        }\n    }\n}\n\nexport default App;\n"]},"metadata":{},"sourceType":"module"}