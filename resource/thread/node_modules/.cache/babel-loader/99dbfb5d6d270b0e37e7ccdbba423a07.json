{"ast":null,"code":"import _classCallCheck from\"/Users/dudac/Documents/_source/strados/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/dudac/Documents/_source/strados/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/dudac/Documents/_source/strados/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/dudac/Documents/_source/strados/dss-thread/resource/thread/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React,{Component}from\"react\";import Container from'react-bootstrap/Container';import Row from'react-bootstrap/Row';import Table from'react-bootstrap/Table';import Tabs from'react-bootstrap/Tabs';import Tab from'react-bootstrap/Tab';import{Modal,Button,Form,Toast}from\"react-bootstrap\";import eventBus from\"../eventBus\";import ReactFlow,{Controls}from'react-flow-renderer';import customFlowNode from'./customFlowNode.js';// import EditColumnModal from \"./editColumnModal\";\nvar Dataset=/*#__PURE__*/function(_Component){_inherits(Dataset,_Component);var _super=_createSuper(Dataset);function Dataset(props){var _this;_classCallCheck(this,Dataset);_this=_super.call(this,props);_this.traverse=function(lst,node,prop){var ct=arguments.length>3&&arguments[3]!==undefined?arguments[3]:0;var res=[];if(node[prop]!=null&&node[prop].length>0){ct=ct+1;for(var x=0;x<node[prop].length;x++){_this.traverse(lst,node[prop][x],prop,ct);}}else{lst[lst.length]={'count':ct-1,'name':node.name};}return res;};_this.update=function(st,base_elem){var elements=[{id:'-1',// type: 'customFlowNode',\ndata:{label:base_elem.name},position:{x:250,y:140},style:{width:'200px',borderColor:'red',borderWidth:'2px',fontWeight:'bold'},sourcePosition:'right',targetPosition:'left',draggable:false}];// find all the end-nodes\nvar down_res=[];if(base_elem.lineage_downstream!=null&&base_elem.lineage_downstream!=''){if(base_elem.lineage_downstream_full!=null)_this.traverse(down_res,base_elem,'lineage_downstream_full');else down_res=eval(base_elem.lineage_downstream);}var up_res=[];if(base_elem.lineage_upstream!=null&&base_elem.lineage_upstream!=''){if(base_elem.lineage_upstream_full!=null)_this.traverse(up_res,base_elem,'lineage_upstream_full');else up_res=eval(base_elem.lineage_upstream);}for(var x=0;x<down_res.length;x++){var lbl=down_res[x];if(lbl.name!=null)lbl=down_res[x].name;var splits=lbl.split('.');var project=splits[0];var dataset='';var col='';if(splits.length>1)dataset=splits[1];if(splits.length>2)col=splits[2];elements[elements.length]={id:'down_'+x,type:'customFlowNode',data:{project:project,dataset:dataset,column:col},style:{width:'200px'},targetPosition:'left',sourcePosition:'right',position:{x:500,y:300/(down_res.length+1)*(x+1)},draggable:false};var edge={id:'-1-down_'+x,source:'-1',target:'down_'+x,arrowHeadType:'arrow'};if(down_res[x].count>0){edge.label='['+down_res[x].count+']';edge.animated=true;}elements[elements.length]=edge;}for(var x=0;x<up_res.length;x++){var lbl=up_res[x];if(lbl.name!=null)lbl=up_res[x].name;var splits=lbl.split('.');var project=splits[0];var dataset='';var col='';if(splits.length>1)dataset=splits[1];if(splits.length>2)col=splits[2];elements[elements.length]={id:'up_'+x,type:'customFlowNode',data:{project:project,dataset:dataset,column:col},style:{width:'200px'},sourcePosition:'right',targetPosition:'left',position:{x:0,y:300/(up_res.length+1)*(x+1)},draggable:false};var edge={id:'-1-up_'+x,source:'up_'+x,target:'-1',arrowHeadType:'arrow'};if(up_res[x].count>0){edge.animated=true;edge.label='['+up_res[x].count+']';}elements[elements.length]=edge;}var new_state={};new_state[st]=elements;_this.setState(new_state);};_this.closeColumn=function(){_this.modalClosed();// this.setState({ showA: true })\n};_this.state={modalDialog:false,selectedCol:{name:'',comment:''},elements:[],col_elements:[],last_ds:'',showA:false};// this.toggleModal = this.toggleModal.bind(this);\n_this.nodeTypes={customFlowNode:customFlowNode};return _this;}_createClass(Dataset,[{key:\"openColumn\",value:function openColumn(col){var _this2=this;// loading the column lineage\nfetch(window.getWebAppBackendUrl('column-lineage'),{method:'POST',body:JSON.stringify({'column':this.createColName(col.name)})}).then(function(res){return res.json();}).then(function(result){col.lineage_downstream=result.downs;col.lineage_upstream=result.ups;_this2.update('col_elements',col);_this2.setState({modalDialog:true,selectedCol:col});//eventBus.dispatch(\"dataRefresh\", {});\n});}},{key:\"createColName\",value:function createColName(col){return this.props.full_ds_name+'.'+col;}},{key:\"formatLineage\",value:function formatLineage(lin){// for (var x = 0; x < lin.length; x++) {\n//     lin[x] = this.createDsLinkFull(lin[x].split('.')[0], lin[x].split('.')[1])\n// }\nif(lin!=null)return lin.join(\", \");return'';}},{key:\"modalClosed\",value:function modalClosed(){this.update('elements',this.props.deets);this.setState({modalDialog:false});}},{key:\"saveColLineage\",value:function saveColLineage(){var cols=[this.createColName(this.state.selectedCol.name)];for(var i=0;i<this.state.selectedCol.lineage_upstream.length;i++){cols[cols.length]=this.state.selectedCol.lineage_upstream[i];}for(var i=0;i<this.state.selectedCol.lineage_downstream.length;i++){cols[cols.length]=this.state.selectedCol.lineage_downstream[i];}this.modalClosed();fetch(window.getWebAppBackendUrl('update-col-desc'),{method:'POST',body:JSON.stringify({'cols':cols,'desc':this.state.selectedCol.comment})}).then(function(res){return res.json();}).then(function(result){eventBus.dispatch(\"dataRefresh\",{});});}},{key:\"saveCol\",value:function saveCol(){// alert(this.state.selectedCol.comment)\nfor(var x=0;x<this.props.deets.schema.columns.length;x++){if(this.props.deets.schema.columns[x].name==this.state.selectedCol.name){this.props.deets.schema.columns[x].comment=this.state.selectedCol.comment;break;}}this.modalClosed();fetch(window.getWebAppBackendUrl('update-col-desc'),{method:'POST',body:JSON.stringify({'cols':[this.createColName(this.state.selectedCol.name)],'desc':this.state.selectedCol.comment,'upstream':false,'downstream':false})}).then(function(res){return res.json();}).then(function(result){eventBus.dispatch(\"dataRefresh\",{});});}},{key:\"createDsLink\",value:function createDsLink(ds){return this.createDsLink2(ds.projectKey,ds.name);}},{key:\"createDsLink2\",value:function createDsLink2(proj,ds){return'/projects/'+proj+'/datasets/'+ds+'/explore/';}},{key:\"createDsLinkFull\",value:function createDsLinkFull(proj,ds){return'<a href=\"'+this.createDsLink2(proj,ds)+'\" target=\"_blank\">'+proj+'.'+ds+'</a>';}},{key:\"onLoad\",value:function onLoad(rv){rv.fitView();}},{key:\"render\",value:function render(){var _this3=this;// setTimeout(() => {\nif(this.props.deets.name!=this.state.last_ds){this.state.last_ds=this.props.deets.name;this.update('elements',this.props.deets);}// }, 500);\nvar listItems=this.props.deets.schema.columns.map(function(col){return/*#__PURE__*/React.createElement(\"tr\",{onClick:function onClick(){return _this3.openColumn(col);}},/*#__PURE__*/React.createElement(\"td\",null,col.name),/*#__PURE__*/React.createElement(\"td\",null,col.type),/*#__PURE__*/React.createElement(\"td\",null,col.comment));});return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Modal,{size:\"lg\",show:this.state.modalDialog,onHide:this.closeColumn,animation:false},/*#__PURE__*/React.createElement(Modal.Header,{closeButton:true},/*#__PURE__*/React.createElement(Modal.Title,null,this.state.selectedCol.name)),/*#__PURE__*/React.createElement(Modal.Body,null,/*#__PURE__*/React.createElement(Container,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{style:{height:300}},/*#__PURE__*/React.createElement(ReactFlow,{onLoad:this.onLoad,elements:this.state.col_elements,nodeTypes:this.nodeTypes},/*#__PURE__*/React.createElement(Controls,{showInteractive:\"false\"})))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Form,{style:{paddingTop:'15px'}},/*#__PURE__*/React.createElement(Form.Group,{className:\"mb-3\"},/*#__PURE__*/React.createElement(Form.Label,null,\"Description\"),/*#__PURE__*/React.createElement(Form.Control,{type:\"text\",defaultValue:this.state.selectedCol.comment,onChange:function onChange(e){return _this3.state.selectedCol.comment=e.target.value;}}),/*#__PURE__*/React.createElement(Form.Text,{className:\"text-muted\"},\"Will be saved to the DSS Column name\")))))),/*#__PURE__*/React.createElement(Modal.Footer,null,/*#__PURE__*/React.createElement(Button,{variant:\"secondary\",onClick:function onClick(){return _this3.saveColLineage();}},\"Save all Lineage\"),/*#__PURE__*/React.createElement(Button,{variant:\"primary\",onClick:function onClick(){return _this3.saveCol();}},\"Save\"))),/*#__PURE__*/React.createElement(Container,{style:{paddingTop:'20px'}},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"h2\",null,/*#__PURE__*/React.createElement(\"a\",{href:this.createDsLink(this.props.deets),target:\"_blank\"},this.props.deets.name,\" (\",this.props.deets.projectKey,\")\"))),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"h4\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Type:\"),\" \",this.props.deets.type)),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"h4\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Last Modified:\"),\" \",this.props.deets.versionTag.lastModifiedBy.login,\" @ \",this.props.deets.versionTag.lastModifiedOn)),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"h4\",null,/*#__PURE__*/React.createElement(\"b\",null,\"Short Desc:\"),\" \",this.props.deets.shortDesc)),/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Toast,{show:this.state.showA,delay:3000,autohide:true,animation:false},/*#__PURE__*/React.createElement(Toast.Header,null,/*#__PURE__*/React.createElement(\"img\",{src:\"holder.js/20x20?text=%20\",className:\"rounded me-2\",alt:\"\"}),/*#__PURE__*/React.createElement(\"strong\",{className:\"me-auto\"},\"Bootstrap\"),/*#__PURE__*/React.createElement(\"small\",null,\"11 mins ago\")),/*#__PURE__*/React.createElement(Toast.Body,null,\"Woohoo, you're reading this text in a Toast!\"))),/*#__PURE__*/React.createElement(Row,{style:{paddingTop:'20px'}},/*#__PURE__*/React.createElement(Tabs,{defaultActiveKey:\"lineage\",id:\"uncontrolled-tab-example\",className:\"mb-3\"},/*#__PURE__*/React.createElement(Tab,{eventKey:\"lineage\",title:\"Lineage\"},/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(\"div\",{style:{height:300}},this.state.elements&&/*#__PURE__*/React.createElement(ReactFlow,{onLoad:this.onLoad,elements:this.state.elements,nodeTypes:this.nodeTypes},/*#__PURE__*/React.createElement(Controls,{showInteractive:\"false\"}))))),/*#__PURE__*/React.createElement(Tab,{eventKey:\"columns\",title:\"Columns\",def:true},/*#__PURE__*/React.createElement(Table,{striped:true,bordered:true,hover:true},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,\"Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Type\"),/*#__PURE__*/React.createElement(\"th\",null,\"Description\"))),/*#__PURE__*/React.createElement(\"tbody\",null,listItems)))))));}}]);return Dataset;}(Component);export default Dataset;","map":{"version":3,"sources":["/Users/dudac/Documents/_source/strados/dss-thread/resource/thread/src/components/dataset.js"],"names":["React","Component","Container","Row","Table","Tabs","Tab","Modal","Button","Form","Toast","eventBus","ReactFlow","Controls","customFlowNode","Dataset","props","traverse","lst","node","prop","ct","res","length","x","name","update","st","base_elem","elements","id","data","label","position","y","style","width","borderColor","borderWidth","fontWeight","sourcePosition","targetPosition","draggable","down_res","lineage_downstream","lineage_downstream_full","eval","up_res","lineage_upstream","lineage_upstream_full","lbl","splits","split","project","dataset","col","type","column","edge","source","target","arrowHeadType","count","animated","new_state","setState","closeColumn","modalClosed","state","modalDialog","selectedCol","comment","col_elements","last_ds","showA","nodeTypes","fetch","window","getWebAppBackendUrl","method","body","JSON","stringify","createColName","then","json","result","downs","ups","full_ds_name","lin","join","deets","cols","i","dispatch","schema","columns","ds","createDsLink2","projectKey","proj","rv","fitView","listItems","map","openColumn","height","onLoad","paddingTop","e","value","saveColLineage","saveCol","createDsLink","versionTag","lastModifiedBy","login","lastModifiedOn","shortDesc"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport Container from 'react-bootstrap/Container';\nimport Row from 'react-bootstrap/Row';\nimport Table from 'react-bootstrap/Table';\nimport Tabs from 'react-bootstrap/Tabs';\nimport Tab from 'react-bootstrap/Tab';\nimport { Modal, Button, Form, Toast } from \"react-bootstrap\";\nimport eventBus from \"../eventBus\";\nimport ReactFlow, { Controls } from 'react-flow-renderer';\nimport customFlowNode from './customFlowNode.js';\n\n// import EditColumnModal from \"./editColumnModal\";\n\nclass Dataset extends Component {\n\n    constructor(props) {\n        super(props);\n\n        this.state = {\n            modalDialog: false,\n            selectedCol: { name: '', comment: '' },\n            elements: [],\n            col_elements: [],\n            last_ds: '',\n            showA: false\n        };\n\n        // this.toggleModal = this.toggleModal.bind(this);\n        this.nodeTypes = {\n            customFlowNode: customFlowNode,\n        };\n    }\n\n    traverse = (lst, node, prop, ct = 0) => {\n        var res = [];\n        if (node[prop] != null && node[prop].length > 0) {\n            ct = ct + 1;\n            for (var x = 0; x < node[prop].length; x++) {\n                this.traverse(lst, node[prop][x], prop, ct);\n            }\n        }\n        else {\n            lst[lst.length] = {\n                'count': ct - 1,\n                'name': node.name\n            }\n        }\n\n        return res;\n    }\n\n\n    update = (st, base_elem) => {\n\n        var elements = [{\n            id: '-1',\n            // type: 'customFlowNode',\n            data: { label: base_elem.name },\n            position: { x: 250, y: 140 },\n            style: { width: '200px', borderColor: 'red', borderWidth: '2px', fontWeight: 'bold' },\n            sourcePosition: 'right',\n            targetPosition: 'left',\n            draggable: false\n        }];\n\n        // find all the end-nodes\n        var down_res = [];\n        if (base_elem.lineage_downstream != null && base_elem.lineage_downstream != '') {\n            if (base_elem.lineage_downstream_full != null)\n                this.traverse(down_res, base_elem, 'lineage_downstream_full');\n            else\n                down_res = eval(base_elem.lineage_downstream);\n        }\n\n        var up_res = [];\n        if (base_elem.lineage_upstream != null && base_elem.lineage_upstream != '') {\n            if (base_elem.lineage_upstream_full != null)\n                this.traverse(up_res, base_elem, 'lineage_upstream_full');\n            else\n                up_res = eval(base_elem.lineage_upstream);\n        }\n\n        for (var x = 0; x < down_res.length; x++) {\n            var lbl = down_res[x];\n            if (lbl.name != null)\n                lbl = down_res[x].name;\n\n            var splits = lbl.split('.');\n            var project = splits[0];\n            var dataset = '';\n            var col = '';\n            if (splits.length > 1)\n                dataset = splits[1];\n            if (splits.length > 2)\n                col = splits[2];\n\n            elements[elements.length] = {\n                id: 'down_' + x,\n                type: 'customFlowNode',\n                data: { project: project, dataset: dataset, column: col },\n                style: { width: '200px' },\n                targetPosition: 'left',\n                sourcePosition: 'right',\n                position: { x: 500, y: ((300 / (down_res.length + 1)) * (x + 1)) },\n                draggable: false\n            }\n\n            var edge = { id: '-1-down_' + x, source: '-1', target: 'down_' + x, arrowHeadType: 'arrow' };\n            if (down_res[x].count > 0) {\n                edge.label = '[' + down_res[x].count + ']';\n                edge.animated = true;\n            }\n\n            elements[elements.length] = edge\n        }\n\n        for (var x = 0; x < up_res.length; x++) {\n            var lbl = up_res[x];\n            if (lbl.name != null)\n                lbl = up_res[x].name;\n\n            var splits = lbl.split('.');\n            var project = splits[0];\n            var dataset = '';\n            var col = '';\n            if (splits.length > 1)\n                dataset = splits[1];\n            if (splits.length > 2)\n                col = splits[2];\n\n            elements[elements.length] = {\n                id: 'up_' + x,\n                type: 'customFlowNode',\n                data: { project: project, dataset: dataset, column: col },\n                style: { width: '200px' },\n                sourcePosition: 'right',\n                targetPosition: 'left',\n                position: { x: 0, y: (300 / (up_res.length + 1) * (x + 1)) },\n                draggable: false\n            }\n\n            var edge = { id: '-1-up_' + x, source: 'up_' + x, target: '-1', arrowHeadType: 'arrow' };\n            if (up_res[x].count > 0) {\n                edge.animated = true;\n                edge.label = '[' + up_res[x].count + ']';\n            }\n\n            elements[elements.length] = edge;\n        }\n        var new_state = {}\n        new_state[st] = elements;\n\n        this.setState(new_state)\n    }\n\n    openColumn(col) {\n        // loading the column lineage\n        fetch(window.getWebAppBackendUrl('column-lineage'), {\n            method: 'POST', body: JSON.stringify({\n                'column': this.createColName(col.name)\n            })\n        })\n            .then(res => res.json())\n            .then(\n                (result) => {\n                    col.lineage_downstream = result.downs;\n                    col.lineage_upstream = result.ups;\n\n                    this.update('col_elements', col);\n                    this.setState({ modalDialog: true, selectedCol: col });\n                    //eventBus.dispatch(\"dataRefresh\", {});\n                });\n    };\n\n    closeColumn = () => {\n        this.modalClosed();\n        // this.setState({ showA: true })\n    }\n\n    createColName(col) {\n        return this.props.full_ds_name + '.' + col;\n    }\n\n    formatLineage(lin) {\n        // for (var x = 0; x < lin.length; x++) {\n        //     lin[x] = this.createDsLinkFull(lin[x].split('.')[0], lin[x].split('.')[1])\n        // }\n\n        if (lin != null)\n            return lin.join(\", \");\n\n        return ''\n    }\n\n    modalClosed() {\n        this.update('elements', this.props.deets);\n        this.setState({ modalDialog: false });\n    }\n\n    saveColLineage() {\n        var cols = [this.createColName(this.state.selectedCol.name)]\n        for (var i = 0; i < this.state.selectedCol.lineage_upstream.length; i++) {\n            cols[cols.length] = this.state.selectedCol.lineage_upstream[i]\n        }\n        for (var i = 0; i < this.state.selectedCol.lineage_downstream.length; i++) {\n            cols[cols.length] = this.state.selectedCol.lineage_downstream[i]\n        }\n        this.modalClosed();\n\n        fetch(window.getWebAppBackendUrl('update-col-desc'), {\n            method: 'POST', body: JSON.stringify({\n                'cols': cols,\n                'desc': this.state.selectedCol.comment\n            })\n        })\n            .then(res => res.json())\n            .then(\n                (result) => {\n                    eventBus.dispatch(\"dataRefresh\", {});\n                });\n    }\n\n    saveCol() {\n        // alert(this.state.selectedCol.comment)\n\n        for (var x = 0; x < this.props.deets.schema.columns.length; x++) {\n            if (this.props.deets.schema.columns[x].name == this.state.selectedCol.name) {\n                this.props.deets.schema.columns[x].comment = this.state.selectedCol.comment;\n                break;\n            }\n        }\n\n        this.modalClosed();\n\n        fetch(window.getWebAppBackendUrl('update-col-desc'), {\n            method: 'POST', body: JSON.stringify({\n                'cols': [this.createColName(this.state.selectedCol.name)],\n                'desc': this.state.selectedCol.comment,\n                'upstream': false,\n                'downstream': false\n            })\n        })\n            .then(res => res.json())\n            .then(\n                (result) => {\n                    eventBus.dispatch(\"dataRefresh\", {});\n                });\n    }\n\n    createDsLink(ds) {\n        return this.createDsLink2(ds.projectKey, ds.name)\n    }\n\n    createDsLink2(proj, ds) {\n        return '/projects/' + proj + '/datasets/' + ds + '/explore/';\n    }\n\n    createDsLinkFull(proj, ds) {\n        return '<a href=\"' + this.createDsLink2(proj, ds) + '\" target=\"_blank\">' + proj + '.' + ds + '</a>';\n    }\n\n    onLoad(rv) {\n        rv.fitView();\n    }\n\n    render() {\n\n        // setTimeout(() => {\n        if (this.props.deets.name != this.state.last_ds) {\n            this.state.last_ds = this.props.deets.name;\n            this.update('elements', this.props.deets);\n        }\n        // }, 500);\n\n        var listItems = this.props.deets.schema.columns.map((col) =>\n            <tr onClick={() => this.openColumn(col)}>\n                <td>{col.name}</td>\n                <td>{col.type}</td>\n                <td>{col.comment}</td>\n            </tr>\n        );\n\n        return (\n            <>\n\n                <Modal size=\"lg\" show={this.state.modalDialog} onHide={this.closeColumn} animation={false}>\n                    <Modal.Header closeButton>\n                        <Modal.Title>{this.state.selectedCol.name}</Modal.Title>\n                    </Modal.Header>\n                    <Modal.Body>\n                        <Container>\n                            {/* <Row>\n                                <b>Downstream:</b><div>{this.formatLineage(this.state.selectedCol.lineage_downstream)}</div>\n                            </Row>\n                            <Row>\n                                <b>Upstream:</b><div>{this.formatLineage(this.state.selectedCol.lineage_upstream)}</div>\n                            </Row> */}\n                            <Row>\n                                <div style={{ height: 300 }}>\n                                    <ReactFlow onLoad={this.onLoad} elements={this.state.col_elements} nodeTypes={this.nodeTypes}>\n                                        <Controls showInteractive=\"false\" />\n                                    </ReactFlow>\n                                </div>\n                            </Row>\n                            <Row>\n                                <Form style={{ paddingTop: '15px' }}>\n                                    <Form.Group className=\"mb-3\">\n                                        <Form.Label>Description</Form.Label>\n                                        <Form.Control type=\"text\" defaultValue={this.state.selectedCol.comment}\n                                            onChange={e => this.state.selectedCol.comment = e.target.value}\n                                        />\n                                        <Form.Text className=\"text-muted\">\n                                            Will be saved to the DSS Column name\n                                        </Form.Text>\n                                    </Form.Group>\n                                </Form>\n                            </Row>\n                        </Container>\n                    </Modal.Body>\n                    <Modal.Footer>\n                        <Button variant=\"secondary\" onClick={() => this.saveColLineage()}>Save all Lineage</Button>\n                        <Button variant=\"primary\" onClick={() => this.saveCol()}>Save</Button>\n                    </Modal.Footer>\n                </Modal>\n\n                <Container style={{ paddingTop: '20px' }}>\n                    <Row><h2><a href={this.createDsLink(this.props.deets)} target=\"_blank\">{this.props.deets.name} ({this.props.deets.projectKey})</a></h2></Row>\n                    <Row><h4><b>Type:</b> {this.props.deets.type}</h4></Row>\n                    <Row><h4><b>Last Modified:</b> {this.props.deets.versionTag.lastModifiedBy.login} @ {this.props.deets.versionTag.lastModifiedOn}</h4></Row>\n                    <Row><h4><b>Short Desc:</b> {this.props.deets.shortDesc}</h4></Row>\n                    <Row>\n                        <Toast show={this.state.showA} delay={3000} autohide animation={false}>\n                            <Toast.Header>\n                                <img\n                                    src=\"holder.js/20x20?text=%20\"\n                                    className=\"rounded me-2\"\n                                    alt=\"\"\n                                />\n                                <strong className=\"me-auto\">Bootstrap</strong>\n                                <small>11 mins ago</small>\n                            </Toast.Header>\n                            <Toast.Body>Woohoo, you're reading this text in a Toast!</Toast.Body>\n                        </Toast>\n                    </Row>\n                    <Row style={{ paddingTop: '20px' }}>\n                        <Tabs defaultActiveKey=\"lineage\" id=\"uncontrolled-tab-example\" className=\"mb-3\">\n                            <Tab eventKey=\"lineage\" title=\"Lineage\">\n                                <Row>\n                                    <div style={{ height: 300 }}>\n                                        {this.state.elements && <ReactFlow onLoad={this.onLoad} elements={this.state.elements} nodeTypes={this.nodeTypes}>\n                                            <Controls showInteractive=\"false\" />\n                                        </ReactFlow>}\n                                    </div>\n                                </Row>\n                            </Tab>\n                            <Tab eventKey=\"columns\" title=\"Columns\" def>\n                                <Table striped bordered hover>\n                                    <thead>\n                                        <tr>\n                                            <th>Name</th>\n                                            <th>Type</th>\n                                            <th>Description</th>\n                                        </tr>\n                                    </thead>\n                                    <tbody>\n                                        {listItems}\n                                    </tbody>\n                                </Table>\n                            </Tab>\n                        </Tabs>\n                    </Row>\n                </Container>\n\n            </>\n        );\n    }\n}\n\n\nexport default Dataset;"]},"metadata":{},"sourceType":"module"}